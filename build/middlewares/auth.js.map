{"version":3,"sources":["../../server/middlewares/auth.js"],"names":["debug","Debug","findUserByEmail","emailSought","users","find","email","required","req","res","next","jwt","verify","headers","token","secret","error","status","json","message","user"],"mappings":";;;;;;;AAAA;;;;AACA;;AACA;;;;;;AAEA,IAAMA,QAAQ,IAAIC,eAAJ,CAAU,iCAAV,CAAd;;AAEA,IAAMC,kBAAkB,SAAlBA,eAAkB,CAACC,WAAD;AAAA,SAAiBC,MAAMC,IAAN,CAAW;AAAA,QAAGC,KAAH,QAAGA,KAAH;AAAA,WAAeA,UAAUH,WAAzB;AAAA,GAAX,CAAjB;AAAA,CAAxB;;AAEA,IAAMI,WAAW,SAAXA,QAAW,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnCC,yBAAIC,MAAJ,CAAWJ,IAAIK,OAAJ,CAAYC,KAAvB,EAA8BC,cAA9B,EAAsC,UAACC,KAAD,EAAQF,KAAR,EAAkB;AACtD,QAAIE,KAAJ,EAAW;AACThB,YAAM,wCAAN;AACA,aAAOS,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,iBAAS,cADiB;AAE1BH;AAF0B,OAArB,CAAP;AAID;;AAEDhB,8BAAwBc,KAAxB;AACAN,QAAIY,IAAJ,GAAWN,MAAMM,IAAjB;AACAV;AACD,GAZD;AAaD,CAdD;;QAiBEH,Q,GAAAA,Q;QACAL,e,GAAAA,e","file":"auth.js","sourcesContent":["import Debug from 'debug'\r\nimport { secret } from './../config'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nconst debug = new Debug('platzi-overflow:auth-middleware')\r\n\r\nconst findUserByEmail = (emailSought) => users.find(({ email }) => email === emailSought)\r\n\r\nconst required = (req, res, next) => {\r\n  jwt.verify(req.headers.token, secret, (error, token) => {\r\n    if (error) {\r\n      debug('JWT was not enctrypted with our secret')\r\n      return res.status(401).json({\r\n        message: 'Unauthorized',\r\n        error\r\n      })\r\n    }\r\n\r\n    debug(`Token verified ${token}`)\r\n    req.user = token.user\r\n    next()\r\n  })\r\n}\r\n\r\nexport {\r\n  required,\r\n  findUserByEmail\r\n}"]}