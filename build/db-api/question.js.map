{"version":3,"sources":["../../server/db-api/question.js"],"names":["debug","Debug","findAll","sort","Question","find","populate","findById","_id","findOne","path","options","model","create","q","question","save","createAnswer","a","answer","Answer","savedAnswer","answers","push"],"mappings":";;;;;;AAAA;;;;AACA;;;;AAEA,IAAMA,QAAQ,IAAIC,eAAJ,CAAU,kCAAV,CAAd;;AAEA,IAAMC,UAAU,SAAVA,OAAU,GAAyB;AAAA,MAAxBC,IAAwB,uEAAjB,YAAiB;;AACvCH,QAAM,uBAAN;AACA,SAAOI,iBAASC,IAAT,GAAgBC,QAAhB,CAAyB,SAAzB,EAAoCH,IAApC,CAAyCA,IAAzC,CAAP;AACD,CAHD;;AAKA,IAAMI,WAAW,SAAXA,QAAW,CAACC,GAAD,EAAS;AACxBR,sCAAkCQ,GAAlC;AACA,SAAOJ,iBACJK,OADI,CACI,EAAED,QAAF,EADJ,EAEJF,QAFI,CAEK;AACRI,UAAM;AADE,GAFL,EAKJJ,QALI,CAKK;AACRI,UAAM,SADE;AAERC,aAAS;AACPR,YAAM;AADC,KAFD;AAKRG,cAAU;AACRI,YAAM,MADE;AAERE,aAAO;AAFC;AALF,GALL,CAAP;AAeD,CAjBD;;AAmBA,IAAMC,SAAS,SAATA,MAAS,CAACC,CAAD,EAAO;AACpBd,mCAA+Bc,CAA/B;AACA,MAAMC,WAAW,IAAIX,gBAAJ,CAAaU,CAAb,CAAjB;AACA,SAAOC,SAASC,IAAT,EAAP;AACD,CAJD;;AAMA,IAAMC,eAAe,SAAfA,YAAe,CAACH,CAAD,EAAII,CAAJ,EAAU;AAC7B,MAAMC,SAAS,IAAIC,cAAJ,CAAWF,CAAX,CAAf;AACA,MAAMG,cAAcF,OAAOH,IAAP,EAApB;AACAF,IAAEQ,OAAF,CAAUC,IAAV,CAAeF,WAAf;AACAP,IAAEE,IAAF;AACA,SAAOK,WAAP;AACD,CAND;;kBAQe;AACbR,gBADa;AAEbI,4BAFa;AAGbf,kBAHa;AAIbK;AAJa,C","file":"question.js","sourcesContent":["import Debug from 'debug'\r\nimport { Question, Answer } from './../models'\r\n\r\nconst debug = new Debug('platzi-overflow:db-api:questions')\r\n\r\nconst findAll = (sort = '-createdAt') => {\r\n  debug('Finding all questions')\r\n  return Question.find().populate('answers').sort(sort)\r\n}\r\n\r\nconst findById = (_id) => {\r\n  debug(`Finding question with id ${_id}`)\r\n  return Question\r\n    .findOne({ _id })\r\n    .populate({\r\n      path: 'user',\r\n    })\r\n    .populate({\r\n      path: 'answers',\r\n      options: {\r\n        sort: '-createdAt'\r\n      },\r\n      populate: {\r\n        path: 'user',\r\n        model: 'User',\r\n      }\r\n    })\r\n}\r\n\r\nconst create = (q) => {\r\n  debug(`Creating new question ${q}`)\r\n  const question = new Question(q)\r\n  return question.save()\r\n}\r\n\r\nconst createAnswer = (q, a) => {\r\n  const answer = new Answer(a)\r\n  const savedAnswer = answer.save()\r\n  q.answers.push(savedAnswer)\r\n  q.save()\r\n  return savedAnswer\r\n}\r\n\r\nexport default {\r\n  create,\r\n  createAnswer,\r\n  findAll,\r\n  findById\r\n}"]}